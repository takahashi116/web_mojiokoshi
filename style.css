/* ========================================
   Chat Transcriber - Styles (Dark + iPhone)
   ======================================== */

:root{
  --color-bg:#0a0a0f;
  --color-surface:rgba(255,255,255,0.03);
  --color-border:rgba(255,255,255,0.08);
  --color-text:#fff;
  --color-text-secondary:rgba(255,255,255,0.65);
  --color-text-muted:rgba(255,255,255,0.45);

  --color-primary:#10b981;
  --color-primary-glow:rgba(16,185,129,0.35);
  --color-accent:#6366f1;
  --color-error:#ef4444;
  --color-success:#22c55e;

  --gradient-primary:linear-gradient(135deg,#10b981,#059669);
  --gradient-accent:linear-gradient(135deg,#6366f1,#8b5cf6);

  --glass-bg:rgba(255,255,255,0.05);
  --glass-border:rgba(255,255,255,0.10);
  --glass-blur:20px;

  --radius-sm:8px;
  --radius-md:12px;
  --radius-lg:20px;

  --spacing-xs:0.5rem;
  --spacing-sm:1rem;
  --spacing-md:1.5rem;
  --spacing-lg:2rem;
  --spacing-xl:3rem;

  --transition-fast:0.15s ease;
  --transition-normal:0.3s ease;

  --font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;

  --safe-area-top:env(safe-area-inset-top);
  --safe-area-bottom:env(safe-area-inset-bottom);
}

*{box-sizing:border-box;margin:0;padding:0;}
html{font-size:16px;}
body{
  font-family:var(--font-family);
  background:var(--color-bg);
  color:var(--color-text);
  min-height:100vh;
  min-height:-webkit-fill-available;
  padding-top:var(--safe-area-top);
  padding-bottom:var(--safe-area-bottom);
  -webkit-font-smoothing:antialiased;
}
body::before{
  content:'';
  position:fixed;inset:0;
  background:
    radial-gradient(ellipse at 20% 20%, rgba(16,185,129,0.08) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 80%, rgba(99,102,241,0.06) 0%, transparent 50%);
  pointer-events:none;z-index:-1;
}

.app-container{
  max-width:800px;
  margin:0 auto;
  padding:var(--spacing-lg);
  min-height:100vh;
  display:flex;flex-direction:column;
}

.header{text-align:center;margin-bottom:var(--spacing-xl);}
.logo{display:flex;align-items:center;justify-content:center;gap:var(--spacing-sm);margin-bottom:var(--spacing-xs);}
.logo-icon{font-size:2rem;}
.logo h1{
  font-size:1.8rem;font-weight:650;
  background:var(--gradient-primary);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  background-clip:text;
}
.tagline{color:var(--color-text-secondary);font-size:0.95rem;font-weight:300;}

.main-content{flex:1;}

.glass-card{
  background:var(--glass-bg);
  backdrop-filter:blur(var(--glass-blur));
  -webkit-backdrop-filter:blur(var(--glass-blur));
  border:1px solid var(--glass-border);
  border-radius:var(--radius-lg);
  padding:var(--spacing-md);
  margin-bottom:var(--spacing-md);
}
.glass-card h2{
  font-size:0.92rem;
  font-weight:500;
  color:var(--color-text-secondary);
  margin-bottom:var(--spacing-sm);
}

.field-label{
  display:block;
  color:var(--color-text-secondary);
  font-size:0.85rem;
  margin-bottom:0.4rem;
}

.text-input, .select-input{
  width:100%;
  padding:0.75rem 1rem;
  background:var(--color-surface);
  border:1px solid var(--color-border);
  border-radius:var(--radius-md);
  color:var(--color-text);
  font-size:16px; /* iOS zoom対策 */
  font-family:inherit;
  -webkit-appearance:none;
}
.text-input:focus, .select-input:focus{outline:none;border-color:var(--color-primary);}

.inline-field{display:flex;align-items:center;gap:var(--spacing-sm);}
.field-note{font-size:0.8rem;color:var(--color-text-muted);white-space:nowrap;}

.grid-2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:var(--spacing-md);
}
.divider{height:1px;background:var(--color-border);margin:var(--spacing-md) 0;}

.api-key-input-group{display:flex;gap:var(--spacing-xs);flex-wrap:wrap;}
.btn-icon{
  width:44px;height:44px;border:1px solid var(--color-border);
  border-radius:var(--radius-md);
  background:var(--color-surface);
  color:var(--color-text);cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all var(--transition-fast);
  -webkit-tap-highlight-color:transparent;
}
.btn-icon:hover{background:rgba(255,255,255,0.1);border-color:var(--color-primary);}
.btn-save{
  height:44px;padding:0 1rem;border:none;border-radius:var(--radius-md);
  background:var(--gradient-primary);color:white;
  font-size:0.85rem;font-weight:600;cursor:pointer;
  transition:all var(--transition-fast);white-space:nowrap;
}
.btn-save:hover{transform:translateY(-1px);box-shadow:0 4px 15px var(--color-primary-glow);}
.btn-save.saved{background:var(--color-success);}
.api-key-file{display:flex;align-items:center;gap:var(--spacing-sm);flex-wrap:wrap;margin-top:var(--spacing-xs);}
.file-label{font-size:0.85rem;color:var(--color-text-secondary);display:flex;align-items:center;gap:var(--spacing-xs);cursor:pointer;}
.file-input{display:none;}
.file-btn{padding:0.4rem 0.8rem;background:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--radius-sm);font-size:0.8rem;}
.status-badge{font-size:0.75rem;padding:0.25rem 0.5rem;border-radius:var(--radius-sm);}
.status-badge.success{background:rgba(34,197,94,0.2);color:var(--color-success);}
.status-badge.error{background:rgba(239,68,68,0.2);color:var(--color-error);}

.source-tabs{display:flex;gap:var(--spacing-xs);margin-bottom:var(--spacing-sm);}
.tab{
  flex:1;
  border:1px solid var(--color-border);
  background:var(--color-surface);
  color:var(--color-text-secondary);
  border-radius:999px;
  padding:0.55rem 0.8rem;
  cursor:pointer;
  transition:all var(--transition-fast);
}
.tab.active{
  background:rgba(16,185,129,0.12);
  border-color:rgba(16,185,129,0.55);
  color:var(--color-text);
}
.panel{padding-top:var(--spacing-xs);}

.row{display:flex;align-items:center;gap:var(--spacing-sm);flex-wrap:wrap;}
.btn-primary{
  border:none;
  background:var(--gradient-accent);
  color:white;
  border-radius:var(--radius-md);
  padding:0.7rem 1rem;
  cursor:pointer;
  font-weight:650;
}
.btn-secondary{
  border:1px solid var(--color-border);
  background:var(--color-surface);
  color:var(--color-text);
  border-radius:var(--radius-md);
  padding:0.7rem 1rem;
  cursor:pointer;
  font-weight:600;
}
.btn-secondary:disabled, .btn-primary:disabled{opacity:0.5;cursor:not-allowed;}
.help-text{margin-top:var(--spacing-sm);font-size:0.82rem;color:var(--color-text-muted);line-height:1.6;}

.dropzone{
  border:2px dashed var(--color-border);
  border-radius:var(--radius-lg);
  padding:var(--spacing-xl);
  text-align:center;
  transition:all var(--transition-normal);
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.dropzone:hover, .dropzone.dragover{border-color:var(--color-primary);background:rgba(16,185,129,0.05);}
.dropzone-icon{font-size:3rem;display:block;margin-bottom:var(--spacing-sm);}
.dropzone-content p{color:var(--color-text-secondary);margin:0.25rem 0;}
.dropzone-hint{font-size:0.8rem;color:var(--color-text-muted) !important;}
.file-select-btn{
  display:inline-block;margin-top:var(--spacing-sm);
  padding:0.6rem 1.2rem;
  background:var(--gradient-accent);
  border-radius:var(--radius-md);
  color:white;font-size:0.9rem;font-weight:650;
  cursor:pointer;transition:all var(--transition-fast);
}
.file-select-btn:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(99,102,241,0.4);}

.file-list{margin-top:var(--spacing-sm);}
.file-item{
  display:flex;align-items:center;justify-content:space-between;
  padding:var(--spacing-sm);
  background:var(--color-surface);
  border-radius:var(--radius-md);
  margin-bottom:var(--spacing-xs);
  gap:var(--spacing-sm);
}
.file-item-info{display:flex;align-items:center;gap:var(--spacing-sm);overflow:hidden;}
.file-item-icon{font-size:1.5rem;flex-shrink:0;}
.file-item-name{font-size:0.9rem;font-weight:650;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.file-item-meta{font-size:0.75rem;color:var(--color-text-muted);}
.file-item-remove{background:none;border:none;color:var(--color-text-muted);cursor:pointer;font-size:1.2rem;padding:0.5rem;flex-shrink:0;}
.file-item-remove:hover{color:var(--color-error);}

.action-section{text-align:center;padding:var(--spacing-md) 0;}
.transcribe-button{
  display:inline-flex;align-items:center;gap:var(--spacing-sm);
  padding:1rem 2.5rem;
  background:var(--gradient-primary);
  border:none;border-radius:var(--radius-lg);
  color:white;font-size:1.08rem;font-weight:750;
  cursor:pointer;transition:all var(--transition-normal);
  box-shadow:0 4px 20px var(--color-primary-glow);
}
.transcribe-button:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 30px var(--color-primary-glow);}
.transcribe-button:disabled{opacity:0.5;cursor:not-allowed;}

.progress-bar{height:8px;background:var(--color-surface);border-radius:var(--radius-sm);overflow:hidden;margin-bottom:var(--spacing-sm);}
.progress-fill{height:100%;width:0%;background:var(--gradient-primary);transition:width 0.3s ease;}
.progress-text{text-align:center;font-size:0.85rem;color:var(--color-text-secondary);}

.results-header{display:flex;align-items:center;justify-content:space-between;gap:var(--spacing-sm);flex-wrap:wrap;}
.results-actions{display:flex;gap:var(--spacing-xs);}

.result-btn{
  padding:0.5rem 0.8rem;
  background:var(--color-surface);
  border:1px solid var(--color-border);
  border-radius:var(--radius-sm);
  color:var(--color-text);
  font-size:0.82rem;
  cursor:pointer;
  transition:all var(--transition-fast);
}
.result-btn:hover{background:rgba(16,185,129,0.15);border-color:rgba(16,185,129,0.55);}
.result-btn:disabled{opacity:0.5;cursor:not-allowed;}

.chat-thread{
  margin-top:var(--spacing-md);
  display:flex;flex-direction:column;
  gap:0.65rem;
}

.msg-row{
  display:flex;
  gap:0.6rem;
  align-items:flex-end;
}
.msg-row .avatar{
  width:34px;height:34px;border-radius:999px;
  background:rgba(255,255,255,0.08);
  border:1px solid var(--color-border);
  display:flex;align-items:center;justify-content:center;
  font-size:0.8rem;color:var(--color-text-secondary);
  flex-shrink:0;
}
.msg-row .bubble-wrap{display:flex;flex-direction:column;gap:0.25rem;max-width:85%;}
.msg-row .speaker-label{
  font-size:0.72rem;
  color:var(--color-text-muted);
  margin-left:0.25rem;
}
.msg-row .bubble{
  padding:0.7rem 0.9rem;
  border-radius:16px;
  background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.08);
  color:var(--color-text);
  line-height:1.65;
  white-space:pre-wrap;
  word-break:break-word;
}
.msg-row.self{flex-direction:row-reverse;}
.msg-row.self .bubble-wrap{align-items:flex-end;}
.msg-row.self .speaker-label{margin-right:0.25rem;margin-left:0;}
.msg-row.self .bubble{
  background:rgba(16,185,129,0.14);
  border-color:rgba(16,185,129,0.32);
}

.raw-json{
  margin-top:var(--spacing-md);
  border:1px solid var(--color-border);
  border-radius:var(--radius-md);
  padding:var(--spacing-sm);
  background:rgba(255,255,255,0.03);
}
.raw-json summary{cursor:pointer;color:var(--color-text-secondary);font-size:0.85rem;}
.raw-json pre{
  margin-top:var(--spacing-sm);
  max-height:260px;
  overflow:auto;
  white-space:pre-wrap;
  color:var(--color-text-secondary);
  font-size:0.82rem;
}

.footer{
  margin-top:auto;
  text-align:center;
  padding-top:var(--spacing-lg);
  padding-bottom:var(--spacing-md);
}
.footer p{font-size:0.75rem;color:var(--color-text-muted);}

@media (max-width:700px){
  .app-container{padding:var(--spacing-md);}
  .grid-2{grid-template-columns:1fr;}
  .transcribe-button{width:100%;justify-content:center;}
  .msg-row .bubble-wrap{max-width:100%;}
}
